let GaugeChart=function(){"use strict";function a(a,b,c){return a>c?1:a<b?0:(a-b)/(c-b)}var b,c,d,e;return class{constructor(a){this.innerRadius=a.innerRadius||50,this.outerRadius=a.outerRadius||0,this.legendSize=a.legendSize||25,this.minValue=a.minValue||0,this.maxValue=a.maxValue||100,this.units=a.units||"",this.margin={Left:1,Right:1,Top:1,Bottom:1},a.margin!=null&&(this.margin.Left=a.margin.Left||1,this.margin.Right=a.margin.Right||1,this.margin.Top=a.margin.Top||1,this.margin.Bottom=a.margin.Bottom||1),this.colorPerPercent=a.colorPerPercent,this.id=a.id,this.value=a.value||0}CreateGaugeChart(){var a=this;b=a.outerRadius+(a.margin.Top+a.margin.Bottom),c=2*a.outerRadius+(a.margin.Left+a.margin.Right),e=[0,0],d="Gauge_"+a.id.replace(/\s+/g,""),a.svg=d3.select("#"+a.id).append("svg").attr("id",d).attr("height",b).attr("width",c).append("g").attr("transform","translate("+(a.margin.Left+a.outerRadius)+","+(a.margin.Top+a.outerRadius)+")"),a.gaugeValue=a.svg.append("g").append("text").attr("x",0).attr("y",0).attr("font-size",a.legendSize+"px").attr("text-anchor","middle");var f=a.svg.append("defs");a.mainGradient=f.append("linearGradient").attr("id","mainGradient"+a.id),a.mainGradient.append("stop").attr("class","stop0"),a.mainGradient.append("stop").attr("class","stop1"),a.mainGradient.append("stop").attr("class","stop2"),a.mainGradient.append("stop").attr("class","stop3"),a.mainGradient.append("stop").attr("class","stop4"),a.mainGradient.append("stop").attr("class","stop5"),a.pie=d3.pie().startAngle(3*Math.PI/2).endAngle(5*Math.PI/2).value(a=>a).sort(null),a.arc=d3.arc().innerRadius(a.innerRadius).outerRadius(a.outerRadius),a.path=a.svg.selectAll("path").data(a.pie(e)).enter().append("path").attr("d",a.arc).attr("class","GaugeArc").attr("fill","WhiteSmoke").attr("stroke","white").attr("stroke-width","2"),a.path.transition().duration(100).attrTween("d",function(b){var c=d3.interpolate(this._current,b);return this._current=c(1),function(b){return a.arc(c(b))}})}UpdateGaugeChart(b){var c=this,f=c.colorPerPercent.map(function(a){return a.color}),g=[a(c.colorPerPercent[0].start,c.minValue,c.maxValue),a(c.colorPerPercent[0].end,c.minValue,c.maxValue),a(c.colorPerPercent[1].start,c.minValue,c.maxValue),a(c.colorPerPercent[1].end,c.minValue,c.maxValue),a(c.colorPerPercent[2].start,c.minValue,c.maxValue),a(c.colorPerPercent[2].end,c.minValue,c.maxValue)];0!=b&&b<c.colorPerPercent[2].start&&(g[5]=g[5]*c.maxValue/b,g[4]=g[4]*c.maxValue/b,g[3]=g[3]*c.maxValue/b,g[2]=g[2]*c.maxValue/b,g[1]=g[1]*c.maxValue/b,g[0]=g[0]*c.maxValue/b),0!=b&&b<c.colorPerPercent[1].end&&(f[2]=f[1]),0!=b&&b<c.colorPerPercent[0].end&&(f[1]=f[0]),c.mainGradient.select(".stop0").attr("stop-color",f[0]).attr("offset",g[0]),c.mainGradient.select(".stop1").attr("stop-color",f[0]).attr("offset",g[1]),c.mainGradient.select(".stop2").attr("stop-color",f[1]).attr("offset",g[2]),c.mainGradient.select(".stop3").attr("stop-color",f[1]).attr("offset",g[3]),c.mainGradient.select(".stop4").attr("stop-color",f[2]).attr("offset",g[4]),c.mainGradient.select(".stop5").attr("stop-color",f[2]).attr("offset",g[5]),e=[b-c.minValue,c.maxValue-b],c.path=c.path.data(c.pie(e));a(b,c.minValue,c.maxValue);c.path.transition().duration(100).attrTween("d",function(a){var b=d3.interpolate(this._current,a);return this._current=b(1),function(a){return c.arc(b(a))}}),d3.select("#"+d).select(".GaugeArc").attr("fill","url(#mainGradient"+c.id+")").attr("stroke","url(#mainGradient"+c.id+")").attr("stroke-width","2"),c.value=Math.round(10*b)/10,c.gaugeValue.text(c.value+" "+c.units)}}}(),PieChart=function(){"use strict";var a,b,c,e;return class{constructor(a){this.innerRadius=a.innerRadius||0,this.outerRadius=a.outerRadius||60,this.units=a.units||"",this.dataset=a.dataset||{id:0,label:"",count:0},this.margin={Left:1,Right:1,Top:1,Bottom:1},a.margin!=null&&(this.margin.Left=a.margin.Left||1,this.margin.Right=a.margin.Right||1,this.margin.Top=a.margin.Top||1,this.margin.Bottom=a.margin.Bottom||1),this.id=a.id,this.legendRectSize=a.legendRectSize||25,this.legendSpacing=a.legendSpacing||6}CreatePieChart(){var f=this;a=2*this.outerRadius+(this.margin.Top+this.margin.Bottom),b=4*this.outerRadius+(this.margin.Left+this.margin.Right),c="Pie_"+this.id.replace(/\s+/g,""),e=d3.scaleOrdinal(d3.schemeCategory10),this.dataset.forEach(function(a){a.enabled=!0}),f.svg=d3.select("#"+this.id).append("svg").attr("id",c).attr("width",b).attr("height",a).append("g").attr("transform","translate("+(this.margin.Left+this.outerRadius)+","+(this.margin.Top+this.outerRadius)+")"),f.arc=d3.arc().innerRadius(this.innerRadius).outerRadius(this.outerRadius),f.pie=d3.pie().value(function(a){return a.count}).sort(null),f.path=f.svg.selectAll("path").data(f.pie(this.dataset)).enter().append("path").attr("d",f.arc).attr("fill",function(a){return e(a.data.label)}).attr("stroke","white").attr("stroke-width","2"),f.path.transition().duration(750).attrTween("d",function(a){var b=d3.interpolate(this._self,a);return this._current=b(1),function(a){return f.arc(b(a))}}),f.tooltip=d3.select("#"+this.id).append("div").attr("class","tooltip"),f.tooltip.append("div").attr("class","label-tooltip").style("font-weight","bold"),f.tooltip.append("div").attr("class","count-tooltip"),f.tooltip.append("div").attr("class","percent-tooltip"),f.path.on("mouseover",function(a){var b=d3.sum(f.dataset.map(function(a){return a.enabled?a.count:0})),c=Math.round(1e3*a.data.count/b)/10;f.tooltip.select(".label-tooltip").html(a.data.label),f.tooltip.select(".count-tooltip").html(a.data.count+" "+f.units),f.tooltip.select(".percent-tooltip").html(c+"%"),f.tooltip.style("display","block"),d3.select(this).attr("stroke","gray-light").attr("stroke-opacity","0.6").attr("fill-opacity","0.8")}),f.path.on("mouseout",function(){f.tooltip.style("display","none"),f.path.attr("stroke","white").attr("stroke-opacity","1").attr("fill-opacity","1")}),f.path.on("mousemove",function(){f.tooltip.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")}),f.legend=f.svg.selectAll(".legend").data(e.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=f.legendRectSize+f.legendSpacing,d=c*e.domain().length/2,g=f.outerRadius+3*f.legendRectSize;return"translate("+g+","+(b*c-d)+")"}),f.legend.append("rect").attr("width",this.legendRectSize).attr("height",this.legendRectSize).style("fill",e).style("stroke",e).style("stroke-width",2).attr("cursor","pointer").on("click",function(a){var b=d3.select(this),c=!0,d=d3.sum(f.dataset.map(function(a){return a.enabled?1:0}));if("disabled"===b.attr("class"))b.attr("class","");else{if(2>d)return;b.attr("class","disabled"),c=!1}f.pie.value(function(b){return b.label===a&&(b.enabled=c),b.enabled?b.count:0}),f.path=f.path.data(f.pie(f.dataset)),f.path.transition().duration(750).attrTween("d",function(a){var b=d3.interpolate(this._current,a);return this._current=b(0),function(a){return f.arc(b(a))}})}),f.legend.append("text").attr("x",this.legendRectSize+this.legendSpacing).attr("y",this.legendRectSize-this.legendSpacing/2).text(function(a){return a}).attr("font-size","14px")}UpdatePieChart(a){var b=this;b.path=b.path.data(b.pie(a)),b.path.transition().duration(750).attrTween("d",function(a){var c=d3.interpolate(this._current,a);return this._current=c(1),function(a){return b.arc(c(a))}})}}}(),DualAxisBarChart=function(){"use strict";var a,b,c,d,e;return class{constructor(a){this.width=a.width||200,this.height=a.height||100,this.paddingInner=a.paddingInner||.2,this.yScaleWidth=a.yScaleWidth||50,this.xScaleHeight=a.xScaleHeight||20,this.yTicks=a.yTicks||5,this.yLeftAxisLegend=a.yLeftAxisLegend||"",this.yRightAxisLegend=a.yRightAxisLegend||"",this.units=a.units||"",this.dataset=a.dataset||[{Equipment:"",RunningTime:0,Failures:0}],this.colorData=a.colorData||["red","green","yellow","blue"],this.barsOpacity=a.barsOpacity||.8,this.margin={Left:1,Right:1,Top:1,Bottom:1},a.margin!=null&&(this.margin.Left=a.margin.Left||1,this.margin.Right=a.margin.Right||1,this.margin.Top=a.margin.Top||1,this.margin.Bottom=a.margin.Bottom||1),this.legendMargin=a.legendMargin||20,this.legendRectSize=a.legendRectSize||20,this.legendSpacing=a.legendSpacing||5,this.id=a.id}CreateDualAxisBarChart(){var f=this;a=f.height+f.xScaleHeight+f.margin.Top+f.margin.Bottom,b=f.width+2*f.yScaleWidth+f.margin.Left+f.margin.Right,c="DualAxisBar_"+f.id.replace(/\s+/g,"");var g=Object.keys(f.dataset[0]),h=g[0];g.shift(),f.svg=d3.select("#"+f.id).append("svg").attr("id",c).attr("width",b).attr("height",a).append("g").attr("transform","translate("+(f.margin.Left+f.yScaleWidth)+","+f.margin.Top+")"),f.yLeftScale=d3.scaleLinear().rangeRound([f.height,0]),f.yRightScale=d3.scaleLinear().rangeRound([f.height,0]),f.xScale=d3.scaleBand().rangeRound([0,f.width]).paddingInner(f.paddingInner).align(.1),f.xAuxScale=d3.scaleBand(),f.colorScale=d3.scaleOrdinal().range(f.colorData).domain(g),f.xAxis=d3.axisBottom(f.xScale),f.x=f.svg.append("g").attr("class","axis").attr("transform","translate(0,"+f.height+")").call(f.xAxis),f.yLeftAxis=d3.axisLeft(f.yLeftScale).ticks(f.yTicks).tickSizeInner(-f.width).tickFormat(a=>a+" "+f.units[0]),f.yLeft=f.svg.append("g").attr("class","left-axis").attr("transform","translate(0,0)").call(f.yLeftAxis).attr("font-size",11),f.yLeft.append("text").attr("transform","rotate(-90)").attr("x",-f.height/2).attr("y",-f.yScaleWidth/2).text(f.yLeftAxisLegend).attr("fill","#000").attr("font-size",12).attr("text-anchor","middle"),f.yRightAxis=d3.axisRight(f.yRightScale).ticks(Math.round(f.yTicks/2)).tickSizeInner(-f.width).tickFormat(a=>a+" "+f.units[1]),f.yRight=f.svg.append("g").attr("class","right-axis").attr("transform","translate("+f.width+",0)").call(f.yRightAxis).attr("font-size",11),f.yRight.append("text").attr("transform","rotate(90)").attr("x",f.height/2).attr("y",-f.yScaleWidth/2).text(f.yRightAxisLegend).attr("fill","#000").attr("font-size",12).attr("text-anchor","middle"),f.tooltip=d3.select("#"+f.id).append("div").attr("class","tooltip"),f.tooltip.append("div").attr("class","label-tooltip").style("font-weight","bold"),f.tooltip.append("div").attr("class","count-tooltip"),f.tooltip.append("div").attr("class","percent-tooltip"),e=f.svg.selectAll(".legend").data(f.colorScale.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=b*f.width/2,d=f.legendMargin+c,e=f.height+2*f.xScaleHeight/3;return"translate("+d+","+e+")"}),e.append("rect").attr("width",f.legendRectSize).attr("height",f.legendRectSize).style("fill",f.colorScale).style("stroke",f.colorScale).attr("fill",f.barsOpacity),e.append("text").attr("x",2*f.legendRectSize).attr("y",f.legendRectSize).text(function(a){return a.replace(/([A-Z])/g," $1").trim()}).attr("fill","#000").style("font-size",12)}UpdateDualAxisBarChart(a){var b=this,c=Object.keys(a[0]),e=c[0];c.shift();var f=d3.max(a,function(a){return a[c[0]]}),g=d3.max(a,function(a){return a[c[1]]});b.yLeftScale.domain([0,f]),b.yLeft.call(b.yLeftAxis),b.yLeft.selectAll(".tick:not(:first-of-type) line").attr("stroke",b.colorScale(c[0])).attr("stroke-dasharray","2,2"),b.yRightScale.domain([0,g]),b.yRight.call(b.yRightAxis),b.yRight.selectAll(".tick:not(:first-of-type) line").attr("stroke",b.colorScale(c[1])).attr("stroke-dasharray","2,2"),b.xScale.domain(b.dataset.map(function(a){return a[e]})),b.x.call(b.xAxis),b.xAuxScale.domain(c).rangeRound([0,b.xScale.bandwidth()]),d=b.svg.selectAll(".group").data(a),d.enter().append("g").attr("class","group").attr("transform",a=>`translate(${b.xScale(a[e])},0)`),b.bars1=d.selectAll(".bar-cat1").data(a=>[a]),b.bars1.transition().attr("height",a=>b.height-b.yLeftScale(a[c[0]])).attr("y",a=>b.yLeftScale(a[c[0]])),b.bars1.enter().append("rect").attr("class","bar-cat1").attr("fill",b.colorScale(c[0])).attr("opacity",b.barsOpacity).attr("x",()=>b.xAuxScale(c[0])).attr("y",a=>b.yLeftScale(a[c[0]])).attr("width",b.xAuxScale.bandwidth()).attr("height",a=>b.height-b.yLeftScale(a[c[0]])).on("mouseover",function(a){d3.select(this).attr("opacity",.8*b.barsOpacity),b.tooltip.select(".label-tooltip").html(a[e]),b.tooltip.select(".count-tooltip").html(c[0].replace(/([A-Z])/g," $1").trim()+": "+a[c[0]]+" "+b.units[0]),b.tooltip.select(".percent-tooltip").html(""),b.tooltip.style("display","block")}).on("mouseout",function(){d3.select(this).attr("opacity",b.barsOpacity),b.tooltip.style("display","none")}).on("mousemove",function(){b.tooltip.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")}),b.bars2=d.selectAll(".bar-cat2").data(a=>[a]),b.bars2.transition().attr("height",a=>b.height-b.yRightScale(a[c[1]])).attr("y",a=>b.yRightScale(a[c[1]])),b.bars2.enter().append("rect").attr("class","bar-cat2").attr("fill",b.colorScale(c[1])).attr("opacity",b.barsOpacity).attr("x",()=>b.xAuxScale(c[1])).attr("y",a=>b.yRightScale(a[c[1]])).attr("width",b.xAuxScale.bandwidth()).attr("height",a=>b.height-b.yRightScale(a[c[1]])).on("mouseover",function(f){d3.select(this).attr("opacity",.8*b.barsOpacity);var d=a.reduce(function(a,b){return a+b[c[1]]},0),g=f[c[1]]/d;b.tooltip.select(".label-tooltip").html(f[e]),b.tooltip.select(".count-tooltip").html(c[1].replace(/([A-Z])/g," $1").trim()+": "+f[c[1]]+" "+b.units[1]),b.tooltip.select(".percent-tooltip").html(Math.round(1e3*g)/10+"%"),b.tooltip.style("display","block")}).on("mouseout",function(){d3.select(this).attr("opacity",b.barsOpacity),b.tooltip.style("display","none")}).on("mousemove",function(){b.tooltip.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})}}}(),StackedBarChart=function(){"use strict";var a,b,c,d,e;return class{constructor(a){this.width=a.width||200,this.height=a.height||100,this.paddingInner=a.paddingInner||.2,this.yScaleWidth=a.yScaleWidth||50,this.xScaleHeight=a.xScaleHeight||20,this.xTicks=a.xTicks||5,this.xAxisLegend=a.xAxisLegend||"",this.legendWidth=a.legendWidth||50,this.legendChartSpace=a.legendChartSpace||a.legendRectSize||20,this.units=a.units||"",this.dataset=a.dataset||[{Equipment:"",GoodBottles:"",RejectedBottles:0}],this.colorData=a.colorData||["red","green","yellow","blue"],this.barsOpacity=a.barsOpacity||.8,this.margin={Left:1,Right:1,Top:1,Bottom:1},a.margin!=null&&(this.margin.Left=a.margin.Left||1,this.margin.Right=a.margin.Right||1,this.margin.Top=a.margin.Top||1,this.margin.Bottom=a.margin.Bottom||1),this.legendRectSize=a.legendRectSize||20,this.legendSpacing=a.legendSpacing||5,this.id=a.id}CreateStackedBarChart(){var f=this;a=f.height+f.xScaleHeight+f.margin.Top+f.margin.Bottom,b=f.width+f.yScaleWidth+f.legendWidth+f.margin.Left+f.margin.Right,c="StackedBar_"+f.id.replace(/\s+/g,"");var g=Object.keys(f.dataset[0]),h=g[0];g.shift(),f.svg=d3.select("#"+f.id).append("svg").attr("id",c).attr("width",b).attr("height",a).append("g").attr("transform","translate("+(f.margin.Left+f.yScaleWidth)+","+f.margin.Top+")"),f.yScale=d3.scaleBand().rangeRound([f.height,0]).paddingInner(f.paddingInner).align(.1),f.xScale=d3.scaleLinear().rangeRound([0,f.width]),f.colorScale=d3.scaleOrdinal().range(f.colorData).domain(g),f.xAxis=d3.axisBottom(f.xScale).ticks(f.xTicks).tickSizeInner(-f.height).tickPadding(10),f.x=f.svg.append("g").attr("class","axis").attr("transform","translate(0,"+f.height+")").call(f.xAxis),f.x.append("text").attr("transform","translate("+f.width/2+","+f.xScaleHeight+")").attr("x",0).attr("y",0).text(f.xAxisLegend).attr("fill","#000").attr("font-size",12).attr("text-anchor","middle"),f.yAxis=d3.axisLeft(f.yScale),f.y=f.svg.append("g").attr("class","axis").attr("transform","translate(0,0)").call(f.yAxis).attr("font-size",11),f.tooltip=d3.select("#"+f.id).append("div").attr("class","tooltip"),f.tooltip.append("div").attr("class","label-tooltip").style("font-weight","bold"),f.tooltip.append("div").attr("class","percent-tooltip"),f.tooltip.append("div").attr("class","count-tooltip"),e=f.svg.selectAll(".legend").data(f.colorScale.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){var c=f.legendRectSize+f.legendSpacing,d=c*f.colorScale.domain().length/2,e=f.width+f.legendWidth-f.legendRectSize,g=f.height/2+b*c-d;return"translate("+e+","+g+")"}),e.append("rect").attr("width",f.legendRectSize).attr("height",f.legendRectSize).style("fill",f.colorScale).style("stroke",f.colorScale).attr("opacity",f.barsOpacity),e.append("text").attr("x",f.legendRectSize-f.legendWidth+f.legendChartSpace).attr("y",f.legendRectSize).text(function(a){return a.replace(/([A-Z])/g," $1").trim()}).attr("fill","#000").attr("font-size",12)}UpdateStackedBarChart(a){var b=this,c=Object.keys(a[0]),e=c[0];c.shift();var f=d3.stack().keys(c),g=d3.max(a,function(a){return c.reduce(function(b,c){return b+a[c]},0)});b.xScale.domain([0,g]),b.x.call(b.xAxis),b.x.selectAll(".tick:not(:first-of-type) line").attr("stroke","#777").attr("stroke-dasharray","2,2"),b.yScale.domain(b.dataset.map(function(a){return a[e]})),b.y.call(b.yAxis),c.forEach(function(a,g){d=b.svg.selectAll(".bar-"+a).data(f(b.dataset)[g],function(b){return b.data[e]+"-"+a}),d.transition().attr("width",a=>b.xScale(a[1])-b.xScale(a[0])).attr("y",a=>b.yScale(a.data[e])).attr("x",a=>b.xScale(a[0])),d.enter().append("rect").attr("class",function(){return"bar bar-"+a}).attr("height",b.yScale.bandwidth()).attr("width",a=>b.xScale(a[1])-b.xScale(a[0])).attr("y",a=>b.yScale(a.data[e])).attr("x",a=>b.xScale(a[0])).attr("fill",()=>b.colorScale(a)).attr("opacity",b.barsOpacity).on("mouseover",function(f){d3.select(this).attr("opacity",.8*b.barsOpacity);var d=c.reduce(function(a,b){return a+f.data[b]},0),g=(f[1]-f[0])/d;b.tooltip.select(".label-tooltip").html(f.data[e]),b.tooltip.select(".percent-tooltip").html(a.replace(/([A-Z])/g," $1").trim()+": "+Math.round(1e3*g)/10+"%"),b.tooltip.select(".count-tooltip").html(f[1]-f[0]+" "+b.units),b.tooltip.style("display","block")}).on("mouseout",function(){d3.select(this).attr("opacity",b.barsOpacity),b.tooltip.style("display","none")}).on("mousemove",function(){b.tooltip.style("top",d3.event.layerY+10+"px").style("left",d3.event.layerX+10+"px")})})}}}();